document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("#reset__button"),t=document.querySelector("#validate__button"),o=document.querySelector("#change__button"),r=document.querySelector("#login__email"),a=document.querySelector("#login__code"),s=document.querySelector("#login__password"),n=document.querySelector("#login__confirm_password"),u=document.querySelector(".step1"),i=document.querySelector(".step2"),d=document.querySelector(".step3"),c=(Math.floor(899999*Math.random()+1e5),!1),l=!1;e.addEventListener("click",e=>{e.preventDefault(),chrome.storage.sync.get(["email"],async e=>{e.email==r.value?(u.classList.add("hidden"),i.classList.remove("hidden"),new Noty({text:"Recovery Code Sent To your email",type:"success",timeout:2e3,theme:"metroui"}).show(),c=!0,await API_REQ({url:"/api/auth",data:{email:e.email}})):new Noty({text:"Invalid Recovery Email",type:"error",timeout:2e3,theme:"metroui"}).show()})}),t.addEventListener("click",async e=>{e.preventDefault();e=await API_REQ({url:"/api/verify",data:{email:r.value,code:a.value}});(e.error?new Noty({text:e.message,type:"error",timeout:2e3,theme:"metroui"}):(i.classList.add("hidden"),d.classList.remove("hidden"),l=!0,new Noty({text:"Code Validated",type:"success",timeout:2e3,theme:"metroui"}))).show()}),o.addEventListener("click",e=>{e.preventDefault(),c&&l?s.value==n.value?((e=new jsSHA("SHA-512","TEXT",{encoding:"UTF8"})).update(s.value),e=e.getHash("HEX"),chrome.storage.sync.set({password:e},()=>{new Noty({text:"Password Changed Successfully! Please login now.",type:"success",timeout:2e3,theme:"metroui"}).show(),d.classList.add("hidden"),s.value="",n.value=""})):new Noty({text:"Password Didn't Match",type:"error",timeout:2e3,theme:"metroui"}).show():new Noty({text:"Something isn't righ!",type:"error",timeout:2e3,theme:"metroui"}).show()})});