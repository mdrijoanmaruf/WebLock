chrome.storage.sync.get(["password","restore_tabs"],n=>{chrome.storage.local.get(["last_tabs"],t=>{if(n.password){let o=document.querySelector("#login__password");document.querySelector("#login__button").addEventListener("click",e=>{e.preventDefault(),console.log("Clicked");e=new jsSHA("SHA-512","TEXT",{encoding:"UTF8"}),e.update(o.value),e=e.getHash("HEX");if(e==n.password){let s=t.last_tabs,a=[];s.forEach((r,o)=>{var e={focused:r.focused,incognito:r.incognito,type:r.type,left:r.left,top:r.top,width:r.width,height:r.height};chrome.windows.create(e,t=>{if(chrome.windows.update(t.id,{state:r.state}),chrome.permissions.contains({permissions:["tabs"]},e=>{if(e&&n.restore_tabs)for(var o of r.tabs)chrome.tabs.create({windowId:t.id,index:o.index,url:o.url,active:o.active,selected:o.selected,pinned:o.pinned})}),s.length===o+1)for(var e of a)chrome.tabs.remove(e)})}),chrome.storage.local.set({last_tabs:[]}),chrome.storage.local.set({browser_locked:!1}),chrome.windows.getCurrent({populate:!1},e=>{chrome.windows.remove(e.id)})}else new Noty({text:"Incorrect Password",type:"error",timeout:2e3,theme:"metroui"}).show()})}else window.location.href="signup.html"});let o=e=>{chrome.storage.local.set({browser_locked:!1},()=>{window.removeEventListener("beforeunload",o)})};window.addEventListener("beforeunload",o)});